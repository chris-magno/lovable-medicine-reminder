<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Medicine Reminder System</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(to right, #e0f2f1, #ffffff);
    padding: 20px;
  }
  h2 {
    color: #004d40;
    text-align: center;
  }
  .card {
    background: #ffffff;
    padding: 20px;
    margin: 15px 0;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  }
  input, textarea {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 6px;
    border: 1px solid #bbb;
  }
  button {
    padding: 12px 25px;
    border: none;
    border-radius: 6px;
    background-color: #00695c;
    color: white;
    cursor: pointer;
    font-weight: bold;
    width: 100%;
  }
  #reminderList .card {
    background: #b2dfdb;
  }
</style>
</head>
<body>

<h2>Medicine Reminder Form</h2>

<div class="card">
  <input type="text" id="patientName" placeholder="Patient Name">
  <input type="text" id="medicine" placeholder="Medicine Name">
  <input type="text" id="dosage" placeholder="Dosage (e.g., 2 pills)">
  <textarea id="notes" placeholder="Additional Notes (Optional)"></textarea>
  <input type="text" id="phone" placeholder="Phone Number (09456035467)">
  <label>Reminder Date & Time:</label>
  <input type="datetime-local" id="datetime">
  <button onclick="addReminder()">Add Reminder</button>
</div>

<h3>Current Reminders</h3>
<div id="reminderList"></div>

<script>
async function addReminder() {
  let patientName = document.getElementById("patientName").value.trim();
  let medicine = document.getElementById("medicine").value.trim();
  let dosage = document.getElementById("dosage").value.trim();
  let notes = document.getElementById("notes").value.trim();
  let phoneNumber = document.getElementById("phone").value.trim();
  let datetime = document.getElementById("datetime").value;

  if (!patientName || !medicine || !dosage || !phoneNumber || !datetime) {
    alert("Please fill all fields.");
    return;
  }

  const res = await fetch(window.location.origin + "/add-reminder", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ patientName, medicine, dosage, notes, phoneNumber, datetime })
  });

  const data = await res.json();

  if (data.success) {
    alert("Reminder added!");
    displayReminders(data.reminders);
  } else {
    alert("Error: " + data.error);
  }
}

function displayReminders(reminders) {
  const container = document.getElementById("reminderList");
  container.innerHTML = "";

  reminders.forEach(r => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <strong>${r.patientName}</strong><br>
      Medicine: ${r.medicine}<br>
      Dosage: ${r.dosage}<br>
      Notes: ${r.notes}<br>
      Phone: ${r.phoneNumber}<br>
      Scheduled: ${new Date(r.datetime).toLocaleString()}<br>
      Status: <strong>${r.sent ? "Sent âœ”" : "Pending..."}</strong>
    `;
    container.appendChild(div);
  });
}

fetch(window.location.origin + "/reminders")
  .then(res => res.json())
  .then(data => displayReminders(data.reminders));
</script>

</body>
</html>
