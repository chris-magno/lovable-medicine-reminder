<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Medicine Reminder System</title>
<style>
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(to right, #e0f7fa, #ffffff);
    padding: 20px;
  }
  h2 { color: #00796b; }
  .card {
    background: rgba(255,255,255,0.9);
    padding: 20px;
    margin: 15px 0;
    border-radius: 12px;
    box-shadow: 0 6px 12px rgba(0,0,0,0.2);
  }
  input, textarea {
    width: 100%; padding: 10px; margin: 8px 0;
    border-radius: 6px; border: 1px solid #ccc;
  }
  button {
    padding: 12px 25px; border: none; border-radius: 6px;
    background-color: #00796b; color: white; cursor: pointer;
    font-weight: bold;
  }
  #reminderList .card {
    background: #b2dfdb;
  }
</style>
</head>
<body>

<h2>Medicine Reminder Form</h2>
<div class="card">
  <input type="text" id="patientName" placeholder="Patient Name">
  <input type="text" id="medicine" placeholder="Medicine Name">
  <input type="text" id="dosage" placeholder="Dosage (e.g., 2 pills)">
  <textarea id="notes" placeholder="Notes (optional)"></textarea>
  <input type="text" id="phone" placeholder="Phone number (09456035467)">
  <label>Reminder Date & Time:</label>
  <input type="datetime-local" id="datetime">
  <br>
  <button onclick="addReminder()">Add Reminder</button>
</div>

<h3>Current Reminders</h3>
<div id="reminderList"></div>

<script>
async function addReminder() {
  let patientName = document.getElementById("patientName").value.trim();
  let medicine = document.getElementById("medicine").value.trim();
  let dosage = document.getElementById("dosage").value.trim();
  let notes = document.getElementById("notes").value.trim();
  let phoneNumber = document.getElementById("phone").value.trim();
  let datetime = document.getElementById("datetime").value;

  if (!patientName || !medicine || !dosage || !phoneNumber || !datetime) {
    alert("Please fill all fields and select date & time.");
    return;
  }

  const res = await fetch("/add-reminder", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ patientName, medicine, dosage, notes, phoneNumber, datetime })
  });

  const data = await res.json();
  if (data.success) {
    alert("Reminder added successfully!");
    displayReminders(data.reminders);
  } else {
    alert("Error: " + data.error);
  }
}

function displayReminders(reminders) {
  const container = document.getElementById("reminderList");
  container.innerHTML = "";
  reminders.forEach(r => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <strong>${r.patientName}</strong> - ${r.medicine} (${r.dosage})<br>
      Notes: ${r.notes}<br>
      Phone: ${r.phoneNumber}<br>
      Scheduled: ${new Date(r.datetime).toLocaleString()}<br>
      Sent: ${r.sent ? "Yes" : "No"}
    `;
    container.appendChild(div);
  });
}

// Load reminders on page load
fetch("/reminders").then(res => res.json()).then(data => displayReminders(data.reminders));
</script>

</body>
</html>
